function netGobrechtsD3Force(t,e,o,n){"use strict";function a(){}var s={conf:{},confDefaults:{},data:{},dom:{},events:{},lib:{},main:{},status:{},tools:{},version:"2.0.1"};return s.main.init=function(){s.dom.containerId=t||"D3Force"+Math.floor(1e6*Math.random()),s.confUser=e||{},s.status.apexPluginId=o,s.status.apexPageItemsToSubmit=n,s.main.setupConfiguration(),s.main.setupDom(),s.main.setupFunctionReferences()},s.main.setupConfiguration=function(){s.conf.debug=s.status.apexPluginId&&1===apex.jQuery("#pdebug").length,s.status.debugPrefix="D3 Force in DOM container #"+s.dom.containerId+": ",s.status.customize=!1,s.status.customizeCurrentMenu="nodes",s.status.customizeCurrentTabPosition=null,s.status.forceTickCounter=0,s.status.forceStartTime=0,s.status.forceRunning=!1,s.status.graphStarted=!1,s.status.graphRendering=!1,s.status.graphReady=!1,s.status.graphOldPositions=null,s.status.sampleData=!1,s.confDefaults.minNodeRadius={display:!0,relation:"node",type:"number",val:6,options:[12,11,10,9,8,7,6,5,4,3,2,1]},s.confDefaults.maxNodeRadius={display:!0,relation:"node",type:"number",val:18,options:[36,34,32,30,28,26,24,22,20,18,16,14,12]},s.confDefaults.colorScheme={display:!0,relation:"node",type:"text",val:"color20",options:["color20","color20b","color20c","color10","direct"]},s.confDefaults.dragMode={display:!0,relation:"node",type:"bool",val:!0,options:[!0,!1]},s.confDefaults.pinMode={display:!0,relation:"node",type:"bool",val:!1,options:[!0,!1]},s.confDefaults.nodeEventToStopPinMode={display:!0,relation:"node",type:"text",val:"contextmenu",options:["none","dblclick","contextmenu"]},s.confDefaults.onNodeContextmenuPreventDefault={display:!0,relation:"node",type:"bool",val:!1,options:[!0,!1]},s.confDefaults.nodeEventToOpenLink={display:!0,relation:"node",type:"text",val:"dblclick",options:["none","click","dblclick","contextmenu"]},s.confDefaults.nodeLinkTarget={display:!0,relation:"node",type:"text",val:"_blank",options:["none","_blank","nodeID","domContainerID"]},s.confDefaults.showLabels={display:!0,relation:"node",type:"bool",val:!0,options:[!0,!1]},s.confDefaults.labelsCircular={display:!0,relation:"node",type:"bool",val:!1,options:[!0,!1]},s.confDefaults.labelDistance={display:!0,relation:"node",type:"number",val:12,options:[30,28,26,24,22,20,18,16,14,12,10,8,6,4,2]},s.confDefaults.preventLabelOverlappingOnForceEnd={display:!0,relation:"node",type:"bool",val:!1,options:[!0,!1]},s.confDefaults.labelPlacementIterations={display:!0,relation:"node",type:"number",val:250,options:[2e3,1e3,500,250,125]},s.confDefaults.showTooltips={display:!0,relation:"node",type:"bool",val:!0,options:[!0,!1]},s.confDefaults.tooltipPosition={display:!0,relation:"node",type:"text",val:"svgTopRight",options:["node","svgTopLeft","svgTopRight"]},s.confDefaults.alignFixedNodesToGrid={display:!0,relation:"node",type:"bool",val:!1,options:[!0,!1]},s.confDefaults.gridSize={display:!0,relation:"node",type:"number",val:50,options:[150,140,130,120,110,100,90,80,70,60,50,40,30,20,10]},s.confDefaults.linkDistance={display:!0,relation:"link",type:"number",val:80,options:[120,110,100,90,80,70,60,50,40,30,20]},s.confDefaults.showLinkDirection={display:!0,relation:"link",type:"bool",val:!0,options:[!0,!1]},s.confDefaults.showSelfLinks={display:!0,relation:"link",type:"bool",val:!0,options:[!0,!1]},s.confDefaults.selfLinkDistance={display:!0,relation:"link",type:"number",val:20,options:[30,28,26,24,22,20,18,16,14,12,10,8]},s.confDefaults.useDomParentWidth={display:!0,relation:"graph",type:"bool",val:!1,options:[!0,!1]},s.confDefaults.width={display:!0,relation:"graph",type:"number",val:500,options:[1200,1150,1100,1050,1e3,950,900,850,800,750,700,650,600,550,500,450,400,350,300]},s.confDefaults.height={display:!0,relation:"graph",type:"number",val:500,options:[1200,1150,1100,1050,1e3,950,900,850,800,750,700,650,600,550,500,450,400,350,300]},s.confDefaults.setDomParentPaddingToZero={display:!0,relation:"graph",type:"bool",val:!1,options:[!0,!1]},s.confDefaults.showBorder={display:!0,relation:"graph",type:"bool",val:!0,options:[!0,!1]},s.confDefaults.showLegend={display:!0,relation:"graph",type:"bool",val:!0,options:[!0,!1]},s.confDefaults.showLoadingIndicatorOnAjaxCall={display:!0,relation:"graph",type:"bool",val:!0,options:[!0,!1]},s.confDefaults.lassoMode={display:!0,relation:"graph",type:"bool",val:!1,options:[!0,!1]},s.confDefaults.zoomMode={display:!0,relation:"graph",type:"bool",val:!1,options:[!0,!1]},s.confDefaults.minZoomFactor={display:!0,relation:"graph",type:"number",val:.2,options:[1,.9,.8,.7,.6,.5,.4,.3,.2,.1]},s.confDefaults.maxZoomFactor={display:!0,relation:"graph",type:"number",val:5,options:[10,9,8,7,6,5,4,3,2,1]},s.confDefaults.transform={display:!1,relation:"graph",type:"object",val:{translate:[0,0],scale:1}},s.confDefaults.autoRefresh={display:!0,relation:"graph",type:"bool",val:!1,options:[!0,!1]},s.confDefaults.refreshInterval={display:!0,relation:"graph",type:"number",val:5e3,options:[6e4,3e4,15e3,1e4,5e3,2500]},s.confDefaults.chargeDistance={display:!1,relation:"graph",type:"number",val:1/0,options:[1/0,25600,12800,6400,3200,1600,800,400,200,100],internal:!0},s.confDefaults.charge={display:!0,relation:"graph",type:"number",val:-350,options:[-1e3,-950,-900,-850,-800,-750,-700,-650,-600,-550,-500,-450,-400,-350,-300,-250,-200,-150,-100,-50,0],internal:!0},s.confDefaults.gravity={display:!0,relation:"graph",type:"number",val:.1,options:[1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.35,.3,.25,.2,.15,.1,.05,0],internal:!0},s.confDefaults.linkStrength={display:!0,relation:"graph",type:"number",val:1,options:[1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.35,.3,.25,.2,.15,.1,.05,0],internal:!0},s.confDefaults.friction={display:!0,relation:"graph",type:"number",val:.9,options:[1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.35,.3,.25,.2,.15,.1,.05,0],internal:!0},s.confDefaults.theta={display:!0,relation:"graph",type:"number",val:.8,options:[1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.35,.3,.25,.2,.15,.1,.05,0],internal:!0},s.conf.debug="undefined"!=typeof s.confUser.debug?s.tools.parseBool(s.confUser.debug):!1,s.conf.minNodeRadius=s.confUser.minNodeRadius||s.confDefaults.minNodeRadius.val,s.conf.maxNodeRadius=s.confUser.maxNodeRadius||s.confDefaults.maxNodeRadius.val,s.conf.colorScheme=s.confUser.colorScheme||s.confDefaults.colorScheme.val,s.conf.dragMode="undefined"!=typeof s.confUser.dragMode?s.tools.parseBool(s.confUser.dragMode):s.confDefaults.dragMode.val,s.conf.pinMode="undefined"!=typeof s.confUser.pinMode?s.tools.parseBool(s.confUser.pinMode):s.confDefaults.pinMode.val,s.conf.nodeEventToStopPinMode=s.confUser.nodeEventToStopPinMode||s.confDefaults.nodeEventToStopPinMode.val,s.conf.onNodeContextmenuPreventDefault="undefined"!=typeof s.confUser.onNodeContextmenuPreventDefault?s.tools.parseBool(s.confUser.onNodeContextmenuPreventDefault):s.confDefaults.onNodeContextmenuPreventDefault.val,s.conf.nodeEventToOpenLink=s.confUser.nodeEventToOpenLink||s.confDefaults.nodeEventToOpenLink.val,s.conf.nodeLinkTarget=s.confUser.nodeLinkTarget||s.confDefaults.nodeLinkTarget.val,s.conf.showLabels="undefined"!=typeof s.confUser.showLabels?s.tools.parseBool(s.confUser.showLabels):s.confDefaults.showLabels.val,s.conf.labelsCircular="undefined"!=typeof s.confUser.labelsCircular?s.tools.parseBool(s.confUser.labelsCircular):s.confDefaults.labelsCircular.val,s.conf.labelDistance=s.confUser.labelDistance||s.confDefaults.labelDistance.val,s.conf.preventLabelOverlappingOnForceEnd="undefined"!=typeof s.confUser.preventLabelOverlappingOnForceEnd?s.tools.parseBool(s.confUser.preventLabelOverlappingOnForceEnd):s.confDefaults.preventLabelOverlappingOnForceEnd.val,s.conf.labelPlacementIterations=s.confUser.labelPlacementIterations||s.confDefaults.labelPlacementIterations.val,s.conf.showTooltips="undefined"!=typeof s.confUser.showTooltips?s.tools.parseBool(s.confUser.showTooltips):s.confDefaults.showTooltips.val,s.conf.tooltipPosition=s.confUser.tooltipPosition||s.confDefaults.tooltipPosition.val,s.conf.alignFixedNodesToGrid="undefined"!=typeof s.confUser.alignFixedNodesToGrid?s.tools.parseBool(s.confUser.alignFixedNodesToGrid):s.confDefaults.alignFixedNodesToGrid.val,s.conf.gridSize=s.confUser.gridSize&&s.confUser.gridSize>0?s.confUser.gridSize:s.confDefaults.gridSize.val,s.conf.linkDistance=s.confUser.linkDistance||s.confDefaults.linkDistance.val,s.conf.showLinkDirection="undefined"!=typeof s.confUser.showLinkDirection?s.tools.parseBool(s.confUser.showLinkDirection):s.confDefaults.showLinkDirection.val,s.conf.showSelfLinks="undefined"!=typeof s.confUser.showSelfLinks?s.tools.parseBool(s.confUser.showSelfLinks):s.confDefaults.showSelfLinks.val,s.conf.selfLinkDistance=s.confUser.selfLinkDistance||s.confDefaults.selfLinkDistance.val,s.conf.useDomParentWidth="undefined"!=typeof s.confUser.useDomParentWidth?s.tools.parseBool(s.confUser.useDomParentWidth):s.confDefaults.useDomParentWidth.val,s.conf.width=s.confUser.width||s.confDefaults.width.val,s.conf.height=s.confUser.height||s.confDefaults.height.val,s.conf.setDomParentPaddingToZero="undefined"!=typeof s.confUser.setDomParentPaddingToZero?s.tools.parseBool(s.confUser.setDomParentPaddingToZero):s.confDefaults.setDomParentPaddingToZero.val,s.conf.showBorder="undefined"!=typeof s.confUser.showBorder?s.tools.parseBool(s.confUser.showBorder):s.confDefaults.showBorder.val,s.conf.showLegend="undefined"!=typeof s.confUser.showLegend?s.tools.parseBool(s.confUser.showLegend):s.confDefaults.showLegend.val,s.conf.showLoadingIndicatorOnAjaxCall="undefined"!=typeof s.confUser.showLoadingIndicatorOnAjaxCall?s.tools.parseBool(s.confUser.showLoadingIndicatorOnAjaxCall):s.confDefaults.showLoadingIndicatorOnAjaxCall.val,s.conf.lassoMode="undefined"!=typeof s.confUser.lassoMode?s.tools.parseBool(s.confUser.lassoMode):s.confDefaults.lassoMode.val,s.conf.zoomMode="undefined"!=typeof s.confUser.zoomMode?s.tools.parseBool(s.confUser.zoomMode):s.confDefaults.zoomMode.val,s.conf.minZoomFactor=s.confUser.minZoomFactor||s.confDefaults.minZoomFactor.val,s.conf.maxZoomFactor=s.confUser.maxZoomFactor||s.confDefaults.maxZoomFactor.val,s.conf.transform=s.confUser.transform||s.confDefaults.transform.val,s.conf.autoRefresh="undefined"!=typeof s.confUser.autoRefresh?s.tools.parseBool(s.confUser.autoRefresh):s.confDefaults.autoRefresh.val,s.conf.refreshInterval=s.confUser.refreshInterval||s.confDefaults.refreshInterval.val,s.conf.chargeDistance=s.confUser.chargeDistance||1/0,s.conf.charge=s.confUser.charge||s.confDefaults.charge.val,s.conf.gravity=s.confUser.gravity||s.confDefaults.gravity.val,s.conf.linkStrength=s.confUser.linkStrength||s.confDefaults.linkStrength.val,s.conf.friction=s.confUser.friction||s.confDefaults.friction.val,s.conf.theta=s.confUser.theta||s.confDefaults.theta.val,s.conf.onNodeMouseenterFunction=s.confUser.onNodeMouseenterFunction||null,s.conf.onNodeMouseleaveFunction=s.confUser.onNodeMouseleaveFunction||null,s.conf.onNodeClickFunction=s.confUser.onNodeClickFunction||null,s.conf.onNodeDblclickFunction=s.confUser.onNodeDblclickFunction||null,s.conf.onNodeContextmenuFunction=s.confUser.onNodeContextmenuFunction||null,s.conf.onLinkClickFunction=s.confUser.onLinkClickFunction||null,s.conf.onLassoStartFunction=s.confUser.onLassoStartFunction||null,s.conf.onLassoEndFunction=s.confUser.onLassoEndFunction||null,s.data.sampleData='<data><nodes ID="7839" LABEL="KING is THE KING, you know?" LABELCIRCULAR="true" COLORVALUE="10" COLORLABEL="Accounting" SIZEVALUE="5000" LINK="http://apex.oracle.com/" INFOSTRING="This visualization is based on the well known emp table." /><nodes ID="7698" LABEL="BLAKE" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="2850" /><nodes ID="7782" LABEL="CLARK" COLORVALUE="10" COLORLABEL="Accounting" SIZEVALUE="2450" /><nodes ID="7566" LABEL="JONES" COLORVALUE="20" COLORLABEL="Research" SIZEVALUE="2975" /><nodes ID="7788" LABEL="SCOTT" COLORVALUE="20" COLORLABEL="Research" SIZEVALUE="3000" /><nodes ID="7902" LABEL="FORD" COLORVALUE="20" COLORLABEL="Research" SIZEVALUE="3000" /><nodes ID="7369" LABEL="SMITH" COLORVALUE="20" COLORLABEL="Research" SIZEVALUE="800" /><nodes ID="7499" LABEL="ALLEN" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="1600" /><nodes ID="7521" LABEL="WARD" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="1250" /><nodes ID="7654" LABEL="MARTIN" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="1250" /><nodes ID="7844" LABEL="TURNER" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="1500" /><nodes ID="7876" LABEL="ADAMS" COLORVALUE="20" COLORLABEL="Research" SIZEVALUE="1100" /><nodes ID="7900" LABEL="JAMES" COLORVALUE="30" COLORLABEL="Sales" SIZEVALUE="950" /><nodes ID="7934" LABEL="MILLER" COLORVALUE="10" COLORLABEL="Accounting" SIZEVALUE="1300" /><nodes ID="8888" LABEL="Who am I?" COLORVALUE="green" COLORLABEL="unspecified" SIZEVALUE="2000" LINK="https://github.com/ogobrecht/d3-force-apex-plugin/wiki/API-Reference#nodelinktarget" INFOSTRING="This is a good question. Think about it." /><nodes ID="9999" LABEL="Where I am?" COLORVALUE="#f00" COLORLABEL="unspecified" SIZEVALUE="1000" LINK="https://github.com/ogobrecht/d3-force-apex-plugin/wiki/API-Reference#nodelinktarget" INFOSTRING="This is a good question. What do you think?" /><links FROMID="7839" TOID="7839" STYLE="dotted" COLOR="blue" INFOSTRING="This is a self link (same source and target node) rendered along a path with the STYLE attribute set to dotted and COLOR attribute set to blue." /><links FROMID="7698" TOID="7839" STYLE="dashed" /><links FROMID="7782" TOID="7839" STYLE="dashed" COLOR="red" INFOSTRING="This is a link with the STYLE attribute set to dashed and COLOR attribute set to red." /><links FROMID="7566" TOID="7839" STYLE="dashed" /><links FROMID="7788" TOID="7566" STYLE="solid" /><links FROMID="7902" TOID="7566" STYLE="solid" /><links FROMID="7369" TOID="7902" STYLE="solid" /><links FROMID="7499" TOID="7698" STYLE="solid" /><links FROMID="7521" TOID="7698" STYLE="solid" /><links FROMID="7654" TOID="7698" STYLE="solid" /><links FROMID="7844" TOID="7698" STYLE="solid" /><links FROMID="7876" TOID="7788" STYLE="solid" /><links FROMID="7900" TOID="7698" STYLE="solid" /><links FROMID="7934" TOID="7782" STYLE="solid" /></data>',s.status.userAgent=navigator.userAgent,s.status.userAgentIe9To11=!1,(-1!==navigator.appVersion.indexOf("MSIE 9")||-1!==navigator.appVersion.indexOf("MSIE 10")||-1!==s.status.userAgent.indexOf("Trident")&&-1!==s.status.userAgent.indexOf("rv:11"))&&(s.status.userAgentIe9To11=!0,s.tools.logError("Houston, we have a problem - user agent is IE 9, 10 or 11 - we have to provide a fix for markers: http://stackoverflow.com/questions/15588478/internet-explorer-10-not-showing-svg-path-d3-js-graph"))},s.main.setupDom=function(){s.dom.body=d3.select("body"),null===document.querySelector("#"+s.dom.containerId)?s.dom.container=s.dom.body.append("div").attr("id",s.dom.containerId):(s.dom.container=d3.select("#"+s.dom.containerId),d3.selectAll("#"+s.dom.containerId+"_tooltip, #"+s.dom.containerId+"_customizing").remove()),null===document.querySelector("#"+s.dom.containerId+" svg")?s.dom.svg=s.dom.container.append("svg"):(s.dom.svg=d3.select("#"+s.dom.containerId+" svg"),d3.selectAll("#"+s.dom.containerId+" svg *").remove()),s.dom.svgParent=d3.select(s.dom.svg.node().parentNode),s.conf.setDomParentPaddingToZero&&s.dom.svgParent.style("padding","0"),s.dom.svg.attr("class","net_gobrechts_d3_force").classed("border",s.conf.showBorder).attr("width",s.conf.width).attr("height",s.conf.height),s.dom.containerWidth=s.tools.getSvgParentInnerWidth(),s.conf.useDomParentWidth&&s.dom.svg.attr("width",s.dom.containerWidth),s.dom.defs=s.dom.svg.append("defs"),s.dom.graphOverlay=s.dom.svg.append("g").attr("class","graphOverlay"),s.dom.graphOverlaySizeHelper=s.dom.graphOverlay.append("rect").attr("class","graphOverlaySizeHelper"),s.dom.graph=s.dom.graphOverlay.append("g").attr("class","graph"),s.dom.legend=s.dom.svg.append("g").attr("class","legend"),s.dom.loading=s.dom.svg.append("svg:g").attr("class","loading").style("display","none"),s.dom.loadingRect=s.dom.loading.append("svg:rect").attr("width",s.tools.getGraphWidth()).attr("height",s.conf.height),s.dom.loadingText=s.dom.loading.append("svg:text").attr("x",s.tools.getGraphWidth()/2).attr("y",s.conf.height/2).text("Loading..."),s.dom.defs.append("svg:marker").attr("id",s.dom.containerId+"_highlighted").attr("class","highlighted").attr("viewBox","0 0 10 10").attr("refX",10).attr("refY",5).attr("markerWidth",5).attr("markerHeight",5).attr("orient","auto").attr("markerUnits","strokeWidth").append("svg:path").attr("d","M0,0 L10,5 L0,10"),s.dom.defs.append("svg:marker").attr("id",s.dom.containerId+"_normal").attr("class","normal").attr("viewBox","0 0 10 10").attr("refX",10).attr("refY",5).attr("markerWidth",5).attr("markerHeight",5).attr("orient","auto").attr("markerUnits","strokeWidth").append("svg:path").attr("d","M0,0 L10,5 L0,10"),null===document.querySelector("#"+s.dom.containerId+"_tooltip")?s.dom.tooltip=s.dom.body.append("div").attr("id",s.dom.containerId+"_tooltip").attr("class","net_gobrechts_d3_force_tooltip").style("top","0px").style("left","0px"):s.dom.tooltip=d3.select("#"+s.dom.containerId+"_tooltip")},s.main.setupFunctionReferences=function(){s.main.force=d3.layout.force().on("start",function(){s.tools.log("Force started."),s.status.customize&&s.dom.customizePositions&&s.dom.customizePositions.text("Force started - wait for end event to show positions..."),s.status.forceTickCounter=0,s.status.forceStartTime=(new Date).getTime(),s.status.forceRunning=!0}).on("tick",function(){s.status.userAgentIe9To11&&s.conf.showLinkDirection&&(s.main.links.each(function(){this.parentNode.insertBefore(this,this)}),s.main.selfLinks.each(function(){this.parentNode.insertBefore(this,this)})),s.main.selfLinks.attr("transform",function(t){return"translate("+t.source.x+","+t.source.y+")"}),s.main.links.attr("x1",function(t){return s.tools.adjustSourceX(t)}).attr("y1",function(t){return s.tools.adjustSourceY(t)}).attr("x2",function(t){return s.tools.adjustTargetX(t)}).attr("y2",function(t){return s.tools.adjustTargetY(t)}),s.conf.showLabels&&(s.main.labels.attr("x",function(t){return t.x}).attr("y",function(t){return t.y-t.radius-s.conf.labelDistance}),s.main.labelPaths.attr("transform",function(t){return"translate("+t.x+","+t.y+")"})),s.main.nodes.attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),s.status.forceTickCounter+=1}).on("end",function(){s.conf.showLabels&&s.conf.preventLabelOverlappingOnForceEnd&&(s.data.simulatedAnnealingLabels=[],s.data.simulatedAnnealingAnchors=[],s.main.labels.each(function(t,e){s.data.simulatedAnnealingLabels[e]={width:this.getBBox().width,height:this.getBBox().height,x:t.x,y:t.y-t.radius-s.conf.labelDistance}}),s.main.nodes.filter(function(t){return!t.LABELCIRCULAR&&!s.conf.labelsCircular}).each(function(t,e){s.data.simulatedAnnealingAnchors[e]={x:t.x,y:t.y-t.radius-s.conf.labelDistance,r:.5}}),s.lib.labelerPlugin().label(s.data.simulatedAnnealingLabels).anchor(s.data.simulatedAnnealingAnchors).width(s.tools.getGraphWidth()).height(s.conf.height).start(s.conf.labelPlacementIterations),s.main.labels.each(function(t,e){d3.select(this).transition().duration(800).attr("x",s.data.simulatedAnnealingLabels[e].x).attr("y",s.data.simulatedAnnealingLabels[e].y)})),s.status.forceRunning=!1;var t=(new Date).getTime()-s.status.forceStartTime,e=(t/1e3).toFixed(1),o=Math.round(s.status.forceTickCounter/(t/1e3)),n=Math.round(t/s.status.forceTickCounter);s.status.customize&&s.dom.customizePositions&&s.dom.customizePositions.text(JSON.stringify(a.positions())),s.tools.log("Force ended."),s.tools.log(e+" seconds, "+s.status.forceTickCounter+" ticks to cool down ("+o+" ticks/s, "+n+" ms/tick).")}),s.main.drag=s.main.force.drag(),s.main.lasso=s.lib.lassoPlugin().closePathDistance(100).closePathSelect(!0).hoverSelect(!0).area(s.dom.graphOverlay).pathContainer(s.dom.svg),s.main.zoom=d3.behavior.zoom()},s.tools.parseBool=function(t){switch(String(t).trim().toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case"":return!1;default:return!1}},s.tools.parseXml=function(t){var e=null;if(t)if(window.DOMParser)try{e=(new DOMParser).parseFromString(t,"text/xml")}catch(o){e=null,s.tools.logError("DOMParser - unable to parse XML: "+o.message)}else if(window.ActiveXObject)try{e=new ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.loadXML(t)||s.tools.logError("Microsoft.XMLDOM - unable to parse XML: "+e.parseError.reason+e.parseError.srcText)}catch(o){e=null,s.tools.logError("Microsoft.XMLDOM - unable to parse XML: "+o.message)}return e},s.tools.xmlToJson=function(t){var e,o,n,a,s,r=null,i=function(t){if(e={},t.attributes.length>0)for(var o=0;o<t.attributes.length;o++)s=t.attributes.item(o),e[s.nodeName]=s.nodeValue;if(t.hasChildNodes())for(var a=0;a<t.childNodes.length;a++)n=t.childNodes.item(a),n.hasChildNodes()?e[n.nodeName]=n.childNodes.item(0).nodeValue:e[n.nodeName]="";return e};if(t&&(r={},r.data={},r.data.nodes=[],r.data.links=[],t.childNodes.item(0).hasChildNodes()))for(var l=0;l<t.childNodes.item(0).childNodes.length;l++)e=null,o=t.childNodes.item(0).childNodes.item(l),a=o.nodeName,"nodes"===a||"node"===a?r.data.nodes.push(i(o)):("links"===a||"link"===a)&&r.data.links.push(i(o));return r},s.tools.getSvgParentInnerWidth=function(){return parseInt(s.dom.svgParent.style("width"))-parseInt(s.dom.svgParent.style("padding-left"))-parseInt(s.dom.svgParent.style("padding-right"))-2*(s.dom.svg.style("border-width")?parseInt(s.dom.svg.style("border-width")):1)},s.tools.getGraphWidth=function(){return s.conf.useDomParentWidth?s.dom.containerWidth:s.conf.width},s.tools.log=function(t,e){s.conf.debug&&(e?console.log(t):console.log(s.status.debugPrefix+t)),s.status.customize&&s.dom.customizeLog&&s.dom.customizeLog.text(t+"\n"+s.dom.customizeLog.text())},s.tools.logError=function(t){console.log(s.status.debugPrefix+"ERROR: "+t),s.status.customize&&s.dom.customizeLog&&s.dom.customizeLog.text("ERROR: "+t+"\n"+s.dom.customizeLog.text())},s.tools.triggerApexEvent=function(t,e,o){s.status.apexPluginId&&apex.event.trigger(t,e,o)},s.tools.setRadiusFunction=function(){s.tools.radius=d3.scale.sqrt().range([s.conf.minNodeRadius,s.conf.maxNodeRadius]).domain(d3.extent(s.data.nodes,function(t){return parseFloat(t.SIZEVALUE)}))},s.tools.setColorFunction=function(){"color20"===s.conf.colorScheme?s.tools.color=d3.scale.category20():"color20b"===s.conf.colorScheme?s.tools.color=d3.scale.category20b():"color20c"===s.conf.colorScheme?s.tools.color=d3.scale.category20c():"color10"===s.conf.colorScheme?s.tools.color=d3.scale.category10():"direct"===s.conf.colorScheme?s.tools.color=function(t){return t}:(s.conf.colorScheme="color20",s.tools.color=d3.scale.category20())},s.tools.neighboring=function(t,e){return s.data.neighbors.indexOf(t.ID+":"+e.ID)>-1||s.data.neighbors.indexOf(e.ID+":"+t.ID)>-1},s.tools.getNearestGridPosition=function(t,e){var o,n;return s.conf.zoomMode?(o=t%s.conf.gridSize,n=o>s.conf.gridSize/2?t-o+s.conf.gridSize:t-o):t>=e?(o=e%s.conf.gridSize,n=e-o,n===e&&(n-=s.conf.gridSize)):t<=s.conf.gridSize/2?n=s.conf.gridSize:(o=t%s.conf.gridSize,n=o>s.conf.gridSize/2?t-o+s.conf.gridSize:t-o,n>=e&&(n-=s.conf.gridSize)),n},s.tools.adjustSourceX=function(t){return t.source.x+Math.cos(s.tools.calcAngle(t))*t.source.radius},s.tools.adjustSourceY=function(t){return t.source.y+Math.sin(s.tools.calcAngle(t))*t.source.radius},s.tools.adjustTargetX=function(t){return t.target.x-Math.cos(s.tools.calcAngle(t))*t.target.radius},s.tools.adjustTargetY=function(t){return t.target.y-Math.sin(s.tools.calcAngle(t))*t.target.radius},s.tools.calcAngle=function(t){return Math.atan2(t.target.y-t.source.y,t.target.x-t.source.x)},s.tools.getSelfLinkPath=function(t){var e=t.source.radius,o=t.source.radius+s.conf.selfLinkDistance,n=0,a=0,r={source:{x:0,y:0,radius:e},target:{x:n+o/2,y:a+o,radius:e}},i={source:{x:n-o/2,y:a+o,radius:e},target:{x:n,y:a,radius:e}},l="M"+s.tools.adjustSourceX(r)+","+s.tools.adjustSourceY(r);return l+=" L"+(n+o/2)+","+(a+o),l+=" A"+o+","+o+" 0 0,1 "+(n-o/2)+","+(a+o),l+=" L"+s.tools.adjustTargetX(i)+","+s.tools.adjustTargetY(i)},s.tools.getLabelPath=function(t){var e=t.radius+s.conf.labelDistance,o=0,n=0,a="M"+(o-e)+","+n;return a+=" a"+e+","+e+" 0 0,1 "+2*e+",0",a+=" a"+e+","+e+" 0 0,1 -"+2*e+",0"},s.tools.openLink=function(t){var e;"none"===s.conf.nodeLinkTarget?window.location.assign(t.LINK):"nodeID"===s.conf.nodeLinkTarget?(e=window.open(t.LINK,t.ID),e.focus()):"domContainerID"===s.conf.nodeLinkTarget?(e=window.open(t.LINK,s.dom.containerId),e.focus()):(e=window.open(t.LINK,s.conf.nodeLinkTarget),e.focus())},s.tools.applyConfigurationObject=function(t){var e;for(e in t)t.hasOwnProperty(e)&&s.conf.hasOwnProperty(e)&&t[e]!==s.conf[e]&&a[e](t[e])},s.tools.zoomEventProxy=function(t){return function(){s.conf.dragMode&&(!s.conf.dragMode||"circle"===d3.event.target.tagName)||!s.conf.zoomMode||d3.event.altKey||d3.event.shiftKey||t.apply(this,arguments)}},s.tools.lassoEventProxy=function(t){return function(){s.conf.dragMode&&"circle"===d3.event.target.tagName||!s.conf.lassoMode||s.conf.zoomMode&&!d3.event.altKey&&!d3.event.shiftKey||t.apply(this,arguments)}},s.tools.showTooltip=function(t){var e;s.dom.tooltip.html(t).style("display","block"),"svgTopLeft"===s.conf.tooltipPosition?(e=s.tools.getOffsetRect(s.dom.svg.node()),s.dom.tooltip.style("top",e.top+(s.dom.svg.style("border-width")?parseInt(s.dom.svg.style("border-width")):1)+"px").style("left",e.left+(s.dom.svg.style("border-width")?parseInt(s.dom.svg.style("border-width")):1)+"px")):"svgTopRight"===s.conf.tooltipPosition?(e=s.tools.getOffsetRect(s.dom.svg.node()),s.dom.tooltip.style("top",e.top+parseInt(s.dom.svg.style("border-width")?parseInt(s.dom.svg.style("border-width")):1)+"px").style("left",e.left+parseInt(s.dom.svg.style("width"))+parseInt(s.dom.svg.style("border-width")?parseInt(s.dom.svg.style("border-width")):1)-parseInt(s.dom.tooltip.style("width"))-2*parseInt(s.dom.tooltip.style("border-width")?parseInt(s.dom.tooltip.style("border-width")):0)-parseInt(s.dom.tooltip.style("padding-left"))-parseInt(s.dom.tooltip.style("padding-right"))+"px")):s.dom.tooltip.style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY+"px")},s.tools.hideTooltip=function(){s.dom.tooltip.style("display","none")},s.tools.onLinkClick=function(t){return d3.event.defaultPrevented?null:(s.tools.log("Event link_click triggered."),s.tools.triggerApexEvent(this,"net_gobrechts_d3_force_linkclick",t),"function"==typeof s.conf.onLinkClickFunction&&s.conf.onLinkClickFunction.call(this,d3.event,t),void 0)},s.tools.getMarkerUrl=function(t){return s.conf.showLinkDirection?"url(#"+s.dom.containerId+"_"+(t.COLOR?t.COLOR:"normal")+")":null},s.tools.getMarkerUrlHighlighted=function(){return s.conf.showLinkDirection?"url(#"+s.dom.containerId+"_highlighted)":null},s.tools.onLinkMouseenter=function(t){s.conf.showTooltips&&t.INFOSTRING&&s.tools.showTooltip(t.INFOSTRING)},s.tools.onLinkMouseleave=function(){s.conf.showTooltips&&s.tools.hideTooltip()},s.tools.onNodeMouseenter=function(t){s.main.nodes.classed("highlighted",function(e){return s.tools.neighboring(e,t)}),s.main.links.classed("highlighted",function(e){return e.source.ID===t.ID||e.target.ID===t.ID}).style("marker-end",function(e){return e.source.ID===t.ID||e.target.ID===t.ID?s.tools.getMarkerUrlHighlighted(e):s.tools.getMarkerUrl(e)}),s.main.selfLinks.classed("highlighted",function(e){return e.FROMID===t.ID}).style("marker-end",function(e){return e.source.ID===t.ID||e.target.ID===t.ID?s.tools.getMarkerUrlHighlighted(e):s.tools.getMarkerUrl(e)}),s.main.labels.classed("highlighted",function(e){return e.ID===t.ID}),s.main.labelsCircular.classed("highlighted",function(e){return e.ID===t.ID}),d3.select(this).classed("highlighted",!0),s.tools.log("Event node_mouseenter triggered."),s.tools.triggerApexEvent(this,"net_gobrechts_d3_force_mouseenter",t),"function"==typeof s.conf.onNodeMouseenterFunction&&s.conf.onNodeMouseenterFunction.call(this,d3.event,t),s.conf.showTooltips&&t.INFOSTRING&&s.tools.showTooltip(t.INFOSTRING)},s.tools.onNodeMouseleave=function(t){s.main.nodes.classed("highlighted",!1),s.main.links.classed("highlighted",!1).style("marker-end",s.tools.getMarkerUrl),s.main.selfLinks.classed("highlighted",!1).style("marker-end",s.tools.getMarkerUrl),s.main.labels.classed("highlighted",!1),s.main.labelsCircular.classed("highlighted",!1),s.tools.log("Event node_mouseleave triggered."),s.tools.triggerApexEvent(this,"net_gobrechts_d3_force_mouseleave",t),"function"==typeof s.conf.onNodeMouseleaveFunction&&s.conf.onNodeMouseleaveFunction.call(this,d3.event,t),s.conf.showTooltips&&s.tools.hideTooltip()},s.tools.onNodeClick=function(t){return d3.event.defaultPrevented?null:(t.LINK&&"click"===s.conf.nodeEventToOpenLink&&s.tools.openLink(t),"click"===s.conf.nodeEventToStopPinMode&&d3.select(this).classed("fixed",t.fixed=0),s.tools.log("Event node_click triggered."),s.tools.triggerApexEvent(this,"net_gobrechts_d3_force_click",t),"function"==typeof s.conf.onNodeClickFunction&&s.conf.onNodeClickFunction.call(this,d3.event,t),void 0)},s.tools.onNodeDblclick=function(t){t.LINK&&"dblclick"===s.conf.nodeEventToOpenLink&&s.tools.openLink(t),"dblclick"===s.conf.nodeEventToStopPinMode&&d3.select(this).classed("fixed",t.fixed=0),s.tools.log("Event node_dblclick triggered."),s.tools.triggerApexEvent(this,"net_gobrechts_d3_force_dblclick",t),"function"==typeof s.conf.onNodeDblclickFunction&&s.conf.onNodeDblclickFunction.call(this,d3.event,t)},s.tools.onNodeContextmenu=function(t){s.conf.onNodeContextmenuPreventDefault&&d3.event.preventDefault(),t.LINK&&"contextmenu"===s.conf.nodeEventToOpenLink&&s.tools.openLink(t),"contextmenu"===s.conf.nodeEventToStopPinMode&&d3.select(this).classed("fixed",t.fixed=0),s.tools.log("Event node_contextmenu triggered."),s.tools.triggerApexEvent(this,"net_gobrechts_d3_force_contextmenu",t),"function"==typeof s.conf.onNodeContextmenuFunction&&s.conf.onNodeContextmenuFunction.call(this,d3.event,t)},s.tools.onLassoStart=function(t){var e={};e.numberOfSelectedNodes=0,e.idsOfSelectedNodes=null,e.numberOfNodes=t.size(),e.nodes=t,s.tools.log("Event lasso_start triggered."),s.tools.triggerApexEvent(document.querySelector("#"+s.dom.containerId),"net_gobrechts_d3_force_lassostart",e),"function"==typeof s.conf.onLassoStartFunction&&s.conf.onLassoStartFunction.call(s.dom.svg,d3.event,e)},s.tools.onLassoEnd=function(t){var e={};e.numberOfSelectedNodes=0,e.idsOfSelectedNodes="",e.numberOfNodes=t.size(),e.nodes=t,t.each(function(t){t.selected&&(e.idsOfSelectedNodes+=t.ID+":",e.numberOfSelectedNodes++)}),e.idsOfSelectedNodes=e.idsOfSelectedNodes.length>0?e.idsOfSelectedNodes.substr(0,e.idsOfSelectedNodes.length-1):null,s.tools.log("Event lasso_end triggered."),s.tools.triggerApexEvent(document.querySelector("#"+s.dom.containerId),"net_gobrechts_d3_force_lassoend",e),"function"==typeof s.conf.onLassoEndFunction&&s.conf.onLassoEndFunction.call(s.dom.svg,d3.event,e)},s.tools.getOffsetRect=function(t){var e=t.getBoundingClientRect(),o=document.body,n=document.documentElement,a=window.pageYOffset||n.scrollTop||o.scrollTop,s=window.pageXOffset||n.scrollLeft||o.scrollLeft,r=n.clientTop||o.clientTop||0,i=n.clientLeft||o.clientLeft||0,l=e.top+a-r,d=e.left+s-i;return{top:Math.round(l),left:Math.round(d)}},s.tools.createLegend=function(){s.data.distinctNodeColorValues.forEach(function(t,e){var o=t.split(";");s.dom.legend.append("circle").attr("cx",11).attr("cy",s.conf.height-(14*(e+1)-3)).attr("r",6).attr("fill",s.tools.color(o[1])),s.dom.legend.append("text").attr("x",21).attr("y",s.conf.height-(14*(e+1)-6)).text(o[0]?o[0]:o[1])})},s.tools.removeLegend=function(){s.dom.legend.selectAll("*").remove()},s.tools.writeConfObjectIntoWizard=function(){s.status.customize&&s.dom.customizeConfObject.text(JSON.stringify(a.optionsCustomizationWizard(),null,"  "))},s.tools.createCustomizeLink=function(){!s.status.customize&&(s.conf.debug||document.querySelector("#apex-dev-toolbar")||document.querySelector("#apexDevToolbar"))&&null===document.querySelector("#"+s.dom.containerId+" svg text.link")&&s.dom.svg.append("svg:text").attr("class","link").attr("x",5).attr("y",15).attr("text-anchor","start").text("Customize Me").on("click",function(){
    a.customize(!0)})},s.tools.removeCustomizeLink=function(){s.dom.svg.select("#"+s.dom.containerId+" svg text.link").remove()},s.tools.customizeDrag=d3.behavior.drag().on("dragstart",function(){var t=d3.mouse(document.body);s.dom.customizePosition=s.tools.getOffsetRect(document.querySelector("#"+s.dom.containerId+"_customizing")),s.dom.customizePosition.mouseLeft=t[0]-s.dom.customizePosition.left,s.dom.customizePosition.mouseTop=t[1]-s.dom.customizePosition.top}).on("drag",function(){var t=d3.mouse(document.body);s.dom.customize.style("left",Math.max(0,t[0]-s.dom.customizePosition.mouseLeft)+"px").style("top",Math.max(0,t[1]-s.dom.customizePosition.mouseTop)+"px")}).on("dragend",function(){s.dom.customizePosition=s.tools.getOffsetRect(s.dom.customize.node())}),s.tools.createCustomizeWizardIfNotRendering=function(){s.status.customize&&!s.status.graphRendering&&s.tools.createCustomizeWizard()},s.tools.createCustomizeWizard=function(){var t,e,o,n,r,i,l,d,c,u=4,f=function(){a.releaseFixedNodes().resume()},m=function(){s.status.customizeCurrentTabPosition=this.id,"text"===s.confDefaults[this.name].type?a[this.name](this.options[this.selectedIndex].value).render():"number"===s.confDefaults[this.name].type?a[this.name](parseFloat(this.options[this.selectedIndex].value)).render():"bool"===s.confDefaults[this.name].type&&a[this.name]("true"===this.options[this.selectedIndex].value).render()},g=function(t){s.confDefaults[t].options.forEach(function(e){l=e,i.append("option").attr("value",e).attr("selected",function(){return"text"===s.confDefaults[t].type||"bool"===s.confDefaults[t].type?l===s.conf[t]?(d=!0,"selected"):null:"number"===s.confDefaults[t].type?parseFloat(l)===s.conf[t]?(d=!0,"selected"):null:void 0}).text(e)})};if(s.status.customize){s.tools.removeCustomizeLink(),s.dom.customizePosition||(s.dom.customizePosition=s.tools.getOffsetRect(s.dom.svg.node()),s.dom.customizePosition.left=s.dom.customizePosition.left+s.conf.width+8),null!==document.querySelector("#"+s.dom.containerId+"_customizing")&&s.dom.customize.remove(),s.dom.customize=s.dom.body.insert("div").attr("id",s.dom.containerId+"_customizing").attr("class","net_gobrechts_d3_force_customize").style("left",s.dom.customizePosition.left+"px").style("top",s.dom.customizePosition.top+"px"),s.dom.customize.append("span").attr("class","drag").call(s.tools.customizeDrag).append("span").attr("class","title").text('Customize "'+s.dom.containerId+'"'),s.dom.customize.append("a").attr("class","close focus").attr("tabindex",1).text("Close").on("click",function(){s.status.customize=!1,s.tools.removeCustomizeWizard(),s.tools.createCustomizeLink()}).on("keydown",function(){13===d3.event.keyCode&&(s.status.customize=!1,s.tools.removeCustomizeWizard(),s.tools.createCustomizeLink())}),t=s.dom.customize.append("table"),e=t.append("tr"),o=e.append("td").style("vertical-align","top"),s.dom.customizeMenu=o.append("span"),s.dom.customizeOptionsTable=o.append("table");for(c in s.confDefaults)s.confDefaults.hasOwnProperty(c)&&s.confDefaults[c].display&&(u+=1,n=s.dom.customizeOptionsTable.append("tr").attr("class",s.confDefaults[c].relation+"-related"),n.append("td").attr("class","label").html('<a href="https://gobrechts.net/wiki/projects/d3-force-apex-plugin#'+c.toLowerCase()+'" target="github_d3_force" tabindex="'+u+'100">'+c+"</a>"),r=n.append("td"),i=r.append("select").attr("id",s.dom.containerId+"_"+c).attr("name",c).attr("value",s.conf[c]).attr("tabindex",u+1).classed("warning",s.confDefaults[c].internal).on("change",m),d=!1,g(c),d||(i.append("option").attr("value",s.conf[c]).attr("selected","selected").text(s.conf[c]),s.confDefaults[c].options.push(s.conf[c])),"pinMode"===c&&r.append("a").text("release all").attr("href",null).on("click",f));s.dom.customizeOptionsTable.style("width",d3.select(s.dom.customizeOptionsTable).node()[0][0].clientWidth+"px"),o.append("span").html("<br>"),o=e.append("td").style("vertical-align","top").style("padding-left","5px"),o.append("span").html('Your Configuration Object<p style="font-size:10px;margin:0;">'+(s.status.apexPluginId?"To save your options please copy<br>this to your plugin region attributes.<br>Only non-default options are shown.</p>":"Use this to initialize your graph.<br>Only non-default options are shown.</p>")),s.dom.customizeConfObject=o.append("textarea").attr("tabindex",u+5).attr("readonly","readonly"),o.append("span").html("<br><br>Current Positions<br>"),s.dom.customizePositions=o.append("textarea").attr("tabindex",u+6).attr("readonly","readonly").text(s.status.forceRunning?"Force started - wait for end event to show positions...":JSON.stringify(a.positions())),o.append("span").html("<br><br>Debug Log (descending)<br>"),s.dom.customizeLog=o.append("textarea").attr("tabindex",u+7).attr("readonly","readonly"),e=t.append("tr"),o=e.append("td").attr("colspan",2).html("Copyrights:"),e=t.append("tr"),o=e.append("td").attr("colspan",2).html('<table><tr><td style="padding-right:20px;"><a href="https://github.com/ogobrecht/d3-force-apex-plugin" target="_blank" tabindex="'+(u+8)+'">D3 Force APEX Plugin</a> ('+s.version+')<br>Ottmar Gobrecht</td><td style="padding-right:20px;"><a href="https://github.com/mbostock/d3" target="d3js_org" tabindex="'+(u+9)+'">D3.js</a> ('+d3.version+') and <a href="https://github.com/d3/d3-plugins/tree/master/lasso" target="_blank" tabindex="'+(u+10)+'">D3 Lasso Plugin</a> (modified)<br>Mike Bostock</td></tr><tr><td colspan="3"><a href="https://github.com/tinker10/D3-Labeler" target="github_d3_labeler" tabindex="'+(u+11)+'">D3 Labeler Plugin</a> (automatic label placement using simulated annealing)<br>Evan Wang</td></tr></table>'),s.tools.createCustomizeMenu(s.status.customizeCurrentMenu),s.tools.writeConfObjectIntoWizard(),s.status.customizeCurrentTabPosition&&document.getElementById(s.status.customizeCurrentTabPosition).focus()}else s.tools.removeCustomizeWizard(),s.tools.createCustomizeLink()},s.tools.removeCustomizeWizard=function(){d3.select("#"+s.dom.containerId+"_customizing").remove()},s.tools.createCustomizeMenu=function(t){s.status.customizeCurrentMenu=t,s.dom.customizeMenu.selectAll("*").remove(),s.dom.customizeMenu.append("span").text("Show options for:"),"nodes"===s.status.customizeCurrentMenu?(s.dom.customizeMenu.append("span").style("font-weight","bold").style("margin-left","10px").text("NODES"),s.dom.customizeOptionsTable.selectAll("tr.node-related").classed("hidden",!1),s.dom.customizeOptionsTable.selectAll("tr.link-related,tr.graph-related").classed("hidden",!0)):s.dom.customizeMenu.append("a").style("font-weight","bold").style("margin-left","10px").text("NODES").attr("tabindex",2).on("click",function(){s.tools.createCustomizeMenu("nodes"),s.dom.customizeOptionsTable.selectAll("tr.node-related").classed("hidden",!1),s.dom.customizeOptionsTable.selectAll("tr.link-related,tr.graph-related").classed("hidden",!0)}).on("keydown",function(){13===d3.event.keyCode&&(s.tools.createCustomizeMenu("nodes"),s.dom.customizeOptionsTable.selectAll("tr.node-related").classed("hidden",!1),s.dom.customizeOptionsTable.selectAll("tr.link-related,tr.graph-related").classed("hidden",!0))}),"links"===s.status.customizeCurrentMenu?(s.dom.customizeMenu.append("span").style("font-weight","bold").style("margin-left","10px").text("LINKS"),s.dom.customizeOptionsTable.selectAll("tr.link-related").classed("hidden",!1),s.dom.customizeOptionsTable.selectAll("tr.node-related,tr.graph-related").classed("hidden",!0)):s.dom.customizeMenu.append("a").style("font-weight","bold").style("margin-left","10px").text("LINKS").attr("tabindex",3).on("click",function(){s.tools.createCustomizeMenu("links"),s.dom.customizeOptionsTable.selectAll("tr.link-related").classed("hidden",!1),s.dom.customizeOptionsTable.selectAll("tr.node-related,tr.graph-related").classed("hidden",!0)}).on("keydown",function(){13===d3.event.keyCode&&(s.tools.createCustomizeMenu("links"),s.dom.customizeOptionsTable.selectAll("tr.link-related").classed("hidden",!1),s.dom.customizeOptionsTable.selectAll("tr.node-related,tr.graph-related").classed("hidden",!0))}),"graph"===s.status.customizeCurrentMenu?(s.dom.customizeMenu.append("span").style("font-weight","bold").style("margin-left","10px").text("GRAPH"),s.dom.customizeOptionsTable.selectAll("tr.graph-related").classed("hidden",!1),s.dom.customizeOptionsTable.selectAll("tr.node-related,tr.link-related").classed("hidden",!0)):s.dom.customizeMenu.append("a").style("font-weight","bold").style("margin-left","10px").text("GRAPH").attr("tabindex",4).on("click",function(){s.tools.createCustomizeMenu("graph"),s.dom.customizeOptionsTable.selectAll("tr.graph-related").classed("hidden",!1),s.dom.customizeOptionsTable.selectAll("tr.node-related,tr.link-related").classed("hidden",!0)}).on("keydown",function(){13===d3.event.keyCode&&(s.tools.createCustomizeMenu("graph"),s.dom.customizeOptionsTable.selectAll("tr.graph-related").classed("hidden",!1),s.dom.customizeOptionsTable.selectAll("tr.node-related,tr.link-related").classed("hidden",!0))}),s.dom.customizeMenu.append("span").html("<br><br>")},s.lib.labelerPlugin=function(){var t,e,o=[],n=[],a=1,s=1,r={},i=5,l=.5,d=0,c=0,u=.2,f=1,m=30,g=30,h=1,p=!1,L=!1,v=function(t){var e=o.length,a=0,s=o[t].x-n[t].x,r=n[t].y-o[t].y,i=Math.sqrt(s*s+r*r),l=!0;i>0&&(a+=i*u),s/=i,r/=i,a+=s>0&&r>0?0:0>s&&r>0?h:0>s&&0>r?2*h:3*h;for(var d,c,p,L,v,y,b,D=o[t].x,I=o[t].y-o[t].height+2,O=o[t].x+o[t].width,k=o[t].y+2,z=0;e>z;z++)z!==t&&(l=x(n[t].x,o[t].x,n[z].x,o[z].x,n[t].y,o[t].y,n[z].y,o[z].y),l&&(a+=f),d=o[z].x,p=o[z].y-o[z].height+2,c=o[z].x+o[z].width,L=o[z].y+2,v=Math.max(0,Math.min(c,O)-Math.max(d,D)),y=Math.max(0,Math.min(L,k)-Math.max(p,I)),b=v*y,a+=b*m),d=n[z].x-n[z].r,p=n[z].y-n[z].r,c=n[z].x+n[z].r,L=n[z].y+n[z].r,v=Math.max(0,Math.min(c,O)-Math.max(d,D)),y=Math.max(0,Math.min(L,k)-Math.max(p,I)),b=v*y,a+=b*g;return a},y=function(e){var r,l=Math.floor(Math.random()*o.length),u=o[l].x,f=o[l].y;r=p?t(l,o,n):v(l),o[l].x+=(Math.random()-.5)*i,o[l].y+=(Math.random()-.5)*i,o[l].x>a&&(o[l].x=u),o[l].x<0&&(o[l].x=u),o[l].y>s&&(o[l].y=f),o[l].y<0&&(o[l].y=f);var m;m=p?t(l,o,n):v(l);var g=m-r;Math.random()<Math.exp(-g/e)?d+=1:(o[l].x=u,o[l].y=f,c+=1)},b=function(e){var r,i=Math.floor(Math.random()*o.length),u=o[i].x,f=o[i].y;r=p?t(i,o,n):v(i);var m=(Math.random()-.5)*l,g=Math.sin(m),h=Math.cos(m);o[i].x-=n[i].x,o[i].y-=n[i].y;var L=o[i].x*h-o[i].y*g,y=o[i].x*g+o[i].y*h;o[i].x=L+n[i].x,o[i].y=y+n[i].y,o[i].x>a&&(o[i].x=u),o[i].x<0&&(o[i].x=u),o[i].y>s&&(o[i].y=f),o[i].y<0&&(o[i].y=f);var b;b=p?t(i,o,n):v(i);var x=b-r;Math.random()<Math.exp(-x/e)?d+=1:(o[i].x=u,o[i].y=f,c+=1)},x=function(t,e,o,n,a,s,r,i){var l,d,c,u,f;return c=(i-r)*(e-t)-(n-o)*(s-a),u=(n-o)*(a-r)-(i-r)*(t-o),f=(e-t)*(a-r)-(s-a)*(t-o),l=u/c,d=f/c,!(0>l||l>1||0>d||d>1)},D=function(t,e,o){return t-e/o};return r.start=function(t){for(var e=o.length,n=1,a=1,s=0;t>s;s++){for(var r=0;e>r;r++)Math.random()<.5?y(n):b(n);n=D(n,a,t)}},r.width=function(t){return arguments.length?(a=t,r):a},r.height=function(t){return arguments.length?(s=t,r):s},r.label=function(t){return arguments.length?(o=t,r):o},r.anchor=function(t){return arguments.length?(n=t,r):n},r.alt_energy=function(e){return arguments.length?(t=e,p=!0,r):v},r.alt_schedule=function(t){return arguments.length?(e=t,L=!0,r):D},r},s.lib.lassoPlugin=function(){function t(){function t(){p="",m.attr("d",null),g.attr("d",null),y=0,o[0].forEach(function(t){t.hoverSelected=!1,t.loopSelected=!1;var e=t.getBBox(),o=t.getCTM();t.lassoPoint={cx:Math.round((e.x+e.width/2)*o.a+o.e),cy:Math.round((e.y+e.height/2)*o.d+o.f),edges:{top:0,right:0,bottom:0,left:0},close_edges:{left:0,right:0}}}),r===!0&&o.on("mouseover.lasso",function(){d3.select(this)[0][0].hoverSelected=!0}),d.start()}function c(){var t,r,i,l,c,u,f,b,x,D,I,O,k,z,E=d3.mouse(this)[0],C=d3.mouse(this)[1],S=function(t){z.x>t.lassoPoint.cx&&(t.lassoPoint.edges.right=t.lassoPoint.edges.right+1),z.x<t.lassoPoint.cx&&(t.lassoPoint.edges.left=t.lassoPoint.edges.left+1)},R=function(t){Math.round(k.y)!==Math.round(I.y)&&Math.round(k.x)>t.lassoPoint.cx&&(t.lassoPoint.close_edges.right=1),Math.round(k.y)!==Math.round(I.y)&&Math.round(k.x)<t.lassoPoint.cx&&(t.lassoPoint.close_edges.left=1)},M=function(t){return t.lassoPoint.cy===Math.round(k.y)},A=function(t){var o;return t.lassoPoint.cy===z.y&&t.lassoPoint.cy!==O.y?(v={x:O.x,y:O.y},o=!1):t.lassoPoint.cy===z.y&&t.lassoPoint.cy===O.y?o=!1:t.lassoPoint.cy===O.y&&t.lassoPoint.cy!==z.y?o=e(t.lassoPoint.cy-z.y)!==e(t.lassoPoint.cy-v.y):(v={x:O.x,y:O.y},o=e(t.lassoPoint.cy-z.y)!==e(t.lassoPoint.cy-O.y)),o};for(""===p?(p=p+"M "+E+" "+C,L=[E,C]):p=p+" L "+E+" "+C,o[0].forEach(function(t){t.lassoPoint.close_edges={left:0,right:0}}),t=Math.sqrt(Math.pow(E-L[0],2)+Math.pow(C-L[1],2)),r="M "+E+" "+C+" L "+L[0]+" "+L[1],m.attr("d",p),n>=t?g.attr("display",null):g.attr("display","none"),s=n>=t,i=d3.select("path")[0][0].attributes.d.value+"Z",h.attr("d",i),f=m.node(),b=f.getTotalLength(),D=f.getPointAtLength(y-1),x=y;b>=x;x++)k=f.getPointAtLength(x),z={x:Math.round(100*k.x)/100,y:Math.round(100*k.y)/100},I=f.getPointAtLength(x-1),O={x:Math.round(100*I.x)/100,y:Math.round(100*I.y)/100},o[0].filter(A).forEach(S);if(s===!0&&a===!0){for(g.attr("d",r),l=g.node(),c=l.getTotalLength(),u={left:0,right:0},x=0;c>=x;x++)k=l.getPointAtLength(x),I=l.getPointAtLength(x-1),o[0].filter(M).forEach(R);o[0].forEach(function(t){t.lassoPoint.edges.left+t.lassoPoint.close_edges.left>0&&(t.lassoPoint.edges.right+t.lassoPoint.close_edges.right)%2===1?t.loopSelected=!0:t.loopSelected=!1})}else o[0].forEach(function(t){t.loopSelected=!1});d3.selectAll(o[0].filter(function(t){return t.loopSelected&&s||t.hoverSelected})).attr("d",function(t){return t.possible=!0,t.possible}),d3.selectAll(o[0].filter(function(t){return!(t.loopSelected&&s||t.hoverSelected)})).attr("d",function(t){return t.possible=!1,t.possible}),d.draw(),y=b+1}function u(){o.on("mouseover.lasso",null),o.filter(function(t){return t.possible===!0}).attr("d",function(t){return t.selected=!0,t.selected}),o.filter(function(t){return t.possible===!1}).attr("d",function(t){return t.selected=!1,t.selected}),o.attr("d",function(t){return t.possible=!1,t.possible}),m.attr("d",null),g.attr("d",null),d.end()}var f,m,g,h,p,L,v,y,b,x=d3.select(this[0][0]);l=l||x,0===l.selectAll("g.lasso").size()?(f=l.append("g").attr("class","lasso"),m=f.append("path").attr("class","drawn"),g=f.append("path").attr("class","loop_close"),h=f.append("path").attr("class","complete_path").attr("display","none")):(f=l.select("g.lasso"),m=f.select("path.drawn"),g=f.select("path.loop_close"),h=f.select("path.complete_path")),b=d3.behavior.drag().on("dragstart",t).on("drag",c).on("dragend",u),i.call(b)}function e(t){return t?0>t?-1:1:0}var o=null,n=75,a=!0,s=!1,r=!0,i=null,l=null,d={start:function(){},draw:function(){},end:function(){}};return t.items=function(e){return arguments.length?(o=e,o[0].forEach(function(t){var e=d3.select(t);"undefined"==typeof e.datum()?e.datum({possible:!1,selected:!1}):e.attr("d",function(t){return t.possible=!1,t.selected=!1,t})}),t):o},t.closePathDistance=function(e){return arguments.length?(n=e,t):n},t.closePathSelect=function(e){return arguments.length?(a=e===!0,t):a},t.isPathClosed=function(e){return arguments.length?(s=e===!0,t):s},t.hoverSelect=function(e){return arguments.length?(r=e===!0,t):r},t.on=function(e,o){if(!arguments.length)return d;if(1===arguments.length)return d[e];var n=["start","draw","end"];return n.indexOf(e)>-1&&(d[e]=o),t},t.area=function(e){return arguments.length?(i=e,t):i},t.pathContainer=function(e){return arguments.length?(l=d3.select(e[0][0]),t):l},t},s.main.init(),a.start=function(t){var e;return t?a.render(t):s.status.apexPluginId?(s.conf.showLoadingIndicatorOnAjaxCall&&a.showLoadingIndicator(!0),apex.server.plugin(s.status.apexPluginId,{p_debug:$v("pdebug"),pageItems:s.status.apexPageItemsToSubmit.split(",")},{success:function(t){s.conf.showLoadingIndicatorOnAjaxCall&&a.showLoadingIndicator(!1),e=t.trim().substr(0,1),"<"===e||"{"===e?a.render(t):"no_query_defined"===t.trim().substr(0,16)?(a.render(),s.tools.logError("No query defined.")):"query_returned_no_data"===t.trim().substr(0,22)?(a.render({data:{nodes:[{ID:"1",LABEL:"ERROR: No data.",COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}}),s.tools.logError("Query returned no data.")):(a.render({data:{nodes:[{ID:"1",LABEL:"ERROR: "+t+".",COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}}),s.tools.logError(t))},error:function(t,e,o){a.render({data:{nodes:[{ID:"1",LABEL:"AJAX call terminated with errors.",COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}}),s.tools.logError("AJAX call terminated with errors: "+o+".")},dataType:"text"})):a.render(),a},a.render=function(t){var e;if(s.status.graphStarted=!0,s.status.graphRendering=!0,s.tools.triggerApexEvent(document.querySelector("#"+s.dom.containerId),"apexbeforerefresh"),t||s.status.graphReady?t&&(s.status.sampleData=!1):(s.tools.logError("Houston, we have a problem - we have to provide sample data."),s.status.sampleData=!0,t=s.data.sampleData),t){if(s.status.graphReady&&(s.status.graphOldPositions=a.positions()),t.constructor===Object)s.data.dataConverted=t,s.conf.debug&&(s.tools.log("Data object:"),s.tools.log(s.data.dataConverted,!0));else if(t.constructor===String){if("<"===t.trim().substr(0,1))try{s.data.dataConverted=s.tools.xmlToJson(s.tools.parseXml(t)),null===s.data.dataConverted&&(e="Unable to convert XML string.",s.tools.logError(e),s.data.dataConverted={data:{nodes:[{ID:"1",LABEL:"ERROR: "+e,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}})}catch(o){e="Unable to convert XML string: "+o.message+".",s.tools.logError(e),s.data.dataConverted={data:{nodes:[{ID:"1",LABEL:"ERROR: "+e,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}}}else if("{"===t.trim().substr(0,1))try{s.data.dataConverted=JSON.parse(t)}catch(o){e="Unable to parse JSON string: "+o.message+".",s.tools.logError(e),s.data.dataConverted={data:{nodes:[{ID:"1",LABEL:"ERROR: "+e,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}}}else e='Your data string is not starting with "<" or "{" - parsing not possible.',s.tools.logError(e),s.data.dataConverted={data:{nodes:[{ID:"1",LABEL:"ERROR: "+e,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}};s.conf.debug&&(s.tools.log("Data string:"),s.tools.log(t,!0),s.tools.log("Converted data object:"),s.tools.log(s.data.dataConverted,!0))}else e="Unable to parse your data - input data can be a XML string, JSON string or JavaScript object.",s.tools.logError(e),s.data.dataConverted={data:{nodes:[{ID:"1",LABEL:"ERROR: "+e,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}};null!==s.data.dataConverted?s.data.dataConverted.hasOwnProperty("data")&&null!==s.data.dataConverted.data?(s.data.dataConverted.data.hasOwnProperty("nodes")&&null!==s.data.dataConverted.data.nodes?(s.data.nodes=s.data.dataConverted.data.nodes,0===s.data.nodes.length&&(e="Your data contains an empty nodes array.",s.tools.logError(e),s.data.nodes=[{ID:"1",LABEL:"ERROR: "+e,COLORVALUE:"1",SIZEVALUE:"1"}])):(e="Your data contains no nodes.",s.tools.logError(e),s.data.nodes=[{ID:"1",LABEL:"ERROR: "+e,COLORVALUE:"1",SIZEVALUE:"1"}]),s.data.dataConverted.data.hasOwnProperty("links")&&null!==s.data.dataConverted.data.links?s.data.links=s.data.dataConverted.data.links:s.data.links=[]):(e="Missing root element named data.",s.tools.logError(e),s.data={nodes:[{ID:"1",LABEL:"ERROR: "+e,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}):(e="Unable to parse your data - please consult the API reference for possible data formats.",s.tools.logError(e),s.data={nodes:[{ID:"1",LABEL:"ERROR: "+e,COLORVALUE:"1",SIZEVALUE:"1"}],links:[]}),s.data.idLookup=[],s.data.nodes.forEach(function(t){t.SIZEVALUE=parseFloat(t.SIZEVALUE),t.LABELCIRCULAR=s.tools.parseBool(t.LABELCIRCULAR),t.fixed&&(t.fixed=s.tools.parseBool(t.fixed)),t.x&&(t.x=parseFloat(t.x)),t.y&&(t.y=parseFloat(t.y)),s.data.idLookup[t.ID]=t}),s.data.links.forEach(function(t){t.source=s.data.idLookup[t.FROMID],t.target=s.data.idLookup[t.TOID]}),s.data.links=s.data.links.filter(function(t){return"undefined"!=typeof t.source&&"undefined"!=typeof t.target}),s.data.neighbors=s.data.links.map(function(t){return t.FROMID+":"+t.TOID}),s.data.distinctNodeColorValues=s.data.nodes.map(function(t){return(t.COLORLABEL?t.COLORLABEL:"")+";"+t.COLORVALUE}).filter(function(t,e,o){return o.indexOf(t)===e}).sort(function(t,e){var o=t.toLowerCase(),n=e.toLowerCase();return n>o?1:o>n?-1:0}),s.data.distinctLinkColorValues=s.data.links.map(function(t){return t.COLOR}).filter(Boolean).filter(function(t,e,o){return o.indexOf(t)===e}).sort(function(t,e){var o=t.toLowerCase(),n=e.toLowerCase();return n>o?1:o>n?-1:0}),s.conf.positions?s.conf.positions.constructor===Array?s.conf.positions.forEach(function(t){void 0!==s.data.idLookup[t.ID]&&(s.data.idLookup[t.ID].fixed||(s.data.idLookup[t.ID].fixed=t.fixed),s.data.idLookup[t.ID].x||(s.data.idLookup[t.ID].x=s.data.idLookup[t.ID].px=t.x),s.data.idLookup[t.ID].y||(s.data.idLookup[t.ID].y=s.data.idLookup[t.ID].py=t.y))}):s.tools.logError("Unable to set node positions: positions method parameter must be an array of node positions"):s.status.graphOldPositions&&s.status.graphOldPositions.forEach(function(t){void 0!==s.data.idLookup[t.ID]&&(s.data.idLookup[t.ID].fixed||(s.data.idLookup[t.ID].fixed=t.fixed),s.data.idLookup[t.ID].x||(s.data.idLookup[t.ID].x=s.data.idLookup[t.ID].px=t.x),s.data.idLookup[t.ID].y||(s.data.idLookup[t.ID].y=s.data.idLookup[t.ID].py=t.y))}),s.conf.positions=null,s.status.graphOldPositions=null}return s.tools.setColorFunction(),s.tools.setRadiusFunction(),s.data.nodes.forEach(function(t){t.radius=s.tools.radius(t.SIZEVALUE)}),s.main.markers=s.dom.defs.selectAll("marker.custom").data(s.data.distinctLinkColorValues,function(t){return t}),s.main.markers.enter().append("svg:marker").attr("id",function(t){return s.dom.containerId+"_"+t}).attr("class","custom").attr("stroke","none").attr("fill",function(t){return t}).attr("viewBox","0 0 10 10").attr("refX",10).attr("refY",5).attr("markerWidth",5).attr("markerHeight",5).attr("orient","auto").attr("markerUnits","strokeWidth").append("svg:path").attr("d","M0,0 L10,5 L0,10"),s.main.markers.exit().remove(),s.main.links=s.dom.graph.selectAll("line.link").data(s.data.links.filter(function(t){return t.FROMID!==t.TOID}),function(t){return t.FROMID+"_"+t.TOID}),s.main.links.enter().append("svg:line").attr("class","link").on("mouseenter",s.tools.onLinkMouseenter).on("mouseleave",s.tools.onLinkMouseleave).on("click",s.tools.onLinkClick),s.main.links.exit().remove(),s.main.links.style("marker-end",s.tools.getMarkerUrl).classed("dotted",function(t){return"dotted"===t.STYLE}).classed("dashed",function(t){return"dashed"===t.STYLE}).style("stroke",function(t){return t.COLOR?t.COLOR:null}),s.main.selfLinks=s.dom.graph.selectAll("path.link").data(s.data.links.filter(function(t){return t.FROMID===t.TOID&&s.conf.showSelfLinks}),function(t){return t.FROMID+"_"+t.TOID}),s.main.selfLinks.enter().append("svg:path").attr("id",function(t){return s.dom.containerId+"_link_"+t.FROMID+"_"+t.TOID}).attr("class","link").on("mouseenter",s.tools.onLinkMouseenter).on("mouseleave",s.tools.onLinkMouseleave).on("click",s.tools.onLinkClick),s.main.selfLinks.exit().remove(),s.main.selfLinks.attr("d",function(t){return s.tools.getSelfLinkPath(t)}).style("marker-end",s.tools.getMarkerUrl).classed("dotted",function(t){return"dotted"===t.STYLE}).classed("dashed",function(t){return"dashed"===t.STYLE}).style("stroke",function(t){return t.COLOR?t.COLOR:null}),s.main.patterns=s.dom.defs.selectAll("pattern").data(s.data.nodes.filter(function(t){return t.IMAGE?!0:!1}),function(t){return t.ID}),s.main.patterns.enter().append("svg:pattern").attr("id",function(t){return s.dom.containerId+"_pattern_"+t.ID}).append("svg:image"),s.main.patterns.exit().remove(),s.main.patterns.each(function(){d3.select(this).attr("x",0).attr("y",0).attr("height",function(t){return 2*t.radius}).attr("width",function(t){return 2*t.radius}),d3.select(this.firstChild).attr("x",0).attr("y",0).attr("height",function(t){return 2*t.radius}).attr("width",function(t){return 2*t.radius}).attr("xlink:href",function(t){return t.IMAGE})}),s.main.nodes=s.dom.graph.selectAll("circle.node").data(s.data.nodes,function(t){return t.ID}),s.main.nodes.enter().append("svg:circle").attr("class","node").attr("cx",function(t){return t.fixed||t.x?void 0:(t.x=Math.floor(Math.random()*s.tools.getGraphWidth()+1),t.x)}).attr("cy",function(t){return t.fixed||t.y?void 0:(t.y=Math.floor(Math.random()*s.conf.height+1),t.y)}).on("mouseenter",s.tools.onNodeMouseenter).on("mouseleave",s.tools.onNodeMouseleave).on("click",s.tools.onNodeClick).on("dblclick",s.tools.onNodeDblclick).on("contextmenu",s.tools.onNodeContextmenu),s.main.nodes.exit().remove(),s.main.nodes.attr("r",function(t){return t.radius}).attr("fill",function(t){return t.IMAGE?"url(#"+s.dom.containerId+"_pattern_"+t.ID+")":s.tools.color(t.COLORVALUE)}),s.conf.showLabels?(s.main.labels=s.dom.graph.selectAll("text.label").data(s.data.nodes.filter(function(t){return!t.LABELCIRCULAR&&!s.conf.labelsCircular}),function(t){return t.ID}),s.main.labels.enter().append("svg:text").attr("class","label"),s.main.labels.exit().remove(),s.main.labels.text(function(t){return t.LABEL}),s.main.labelPaths=s.dom.defs.selectAll("path.label").data(s.data.nodes.filter(function(t){return t.LABELCIRCULAR||s.conf.labelsCircular}),function(t){return t.ID}),s.main.labelPaths.enter().append("svg:path").attr("id",function(t){return s.dom.containerId+"_textPath_"+t.ID}).attr("class","label"),s.main.labelPaths.exit().remove(),s.main.labelPaths.attr("d",function(t){return s.tools.getLabelPath(t)}),s.main.labelsCircular=s.dom.graph.selectAll("text.labelCircular").data(s.data.nodes.filter(function(t){return t.LABELCIRCULAR||s.conf.labelsCircular}),function(t){return t.ID}),s.main.labelsCircular.enter().append("svg:text").attr("class","labelCircular").append("svg:textPath").attr("xlink:href",function(t){return"#"+s.dom.containerId+"_textPath_"+t.ID}),s.main.labelsCircular.exit().remove(),s.main.labelsCircular.each(function(t){d3.select(this.firstChild).text(t.LABEL)})):(s.dom.defs.selectAll("path.label").remove(),s.dom.graph.selectAll("text.label,text.labelCircular").remove()),a.debug(s.conf.debug).showBorder(s.conf.showBorder).setDomParentPaddingToZero(s.conf.setDomParentPaddingToZero).useDomParentWidth(s.conf.useDomParentWidth).width(s.conf.width).height(s.conf.height).alignFixedNodesToGrid(s.conf.alignFixedNodesToGrid).dragMode(s.conf.dragMode).pinMode(s.conf.pinMode).lassoMode(s.conf.lassoMode).zoomMode(s.conf.zoomMode).transform(s.conf.transform).autoRefresh(s.conf.autoRefresh).linkDistance(s.conf.linkDistance).charge(s.conf.charge).chargeDistance(s.conf.chargeDistance).gravity(s.conf.gravity).linkStrength(s.conf.linkStrength).friction(s.conf.friction).theta(s.conf.theta),s.main.force.nodes(s.data.nodes).links(s.data.links).start(),s.status.customize?s.tools.createCustomizeWizard():s.tools.createCustomizeLink(),s.status.graphReady=!0,s.status.graphRendering=!1,s.tools.triggerApexEvent(document.querySelector("#"+s.dom.containerId),"apexafterrefresh"),a},a.resume=function(){return s.main.force.resume(),s.tools.createCustomizeWizardIfNotRendering(),a},a.showBorder=function(t){return arguments.length?(s.conf.showBorder=t,s.status.graphStarted&&(s.dom.svg.classed("border",s.conf.showBorder),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.showBorder},a.showLegend=function(t){return arguments.length?(s.conf.showLegend=t,s.status.graphStarted&&(s.conf.showLegend?(s.tools.removeLegend(),s.tools.createLegend()):s.tools.removeLegend(),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.showLegend},a.showSelfLinks=function(t){return arguments.length?(s.conf.showSelfLinks=t,s.status.graphStarted&&s.tools.createCustomizeWizardIfNotRendering(),a):s.conf.showSelfLinks},a.showLinkDirection=function(t){return arguments.length?(s.conf.showLinkDirection=t,s.status.graphStarted&&s.tools.createCustomizeWizardIfNotRendering(),a):s.conf.showLinkDirection},a.showTooltips=function(t){return arguments.length?(s.conf.showTooltips=t,s.status.graphStarted&&s.tools.createCustomizeWizardIfNotRendering(),a):s.conf.showTooltips},a.tooltipPosition=function(t){return arguments.length?(s.conf.tooltipPosition=t,s.status.graphStarted&&s.tools.createCustomizeWizardIfNotRendering(),a):s.conf.tooltipPosition},a.colorScheme=function(t){return arguments.length?(s.conf.colorScheme=t,s.tools.setColorFunction(),s.status.graphStarted&&(s.main.nodes.attr("fill",function(t){return t.IMAGE?"url(#"+s.dom.containerId+"_pattern_"+t.ID+")":s.tools.color(t.COLORVALUE)}),s.conf.showLegend&&(s.tools.removeLegend(),s.tools.createLegend()),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.colorScheme},a.showLabels=function(t){return arguments.length?(s.conf.showLabels=t,s.status.graphStarted&&s.tools.createCustomizeWizardIfNotRendering(),a):s.conf.showLabels},a.labelsCircular=function(t){return arguments.length?(s.conf.labelsCircular=t,s.status.graphStarted&&s.tools.createCustomizeWizardIfNotRendering(),a):s.conf.labelsCircular},a.preventLabelOverlappingOnForceEnd=function(t){return arguments.length?(s.conf.preventLabelOverlappingOnForceEnd=t,s.status.graphStarted&&s.tools.createCustomizeWizardIfNotRendering(),a):s.conf.preventLabelOverlappingOnForceEnd},a.labelPlacementIterations=function(t){return arguments.length?(s.conf.labelPlacementIterations=t,s.status.graphStarted&&s.tools.createCustomizeWizardIfNotRendering(),a):s.conf.labelPlacementIterations},a.dragMode=function(t){return arguments.length?(s.conf.dragMode=t,s.status.graphStarted&&(s.conf.dragMode?s.main.nodes.call(s.main.drag):(s.main.nodes.on("mousedown.drag",null),s.main.nodes.on("touchstart.drag",null)),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.dragMode},a.pinMode=function(t){return arguments.length?(s.conf.pinMode=t,s.status.graphStarted&&(s.conf.pinMode?s.main.drag.on("dragstart",function(t){d3.select(this).classed("fixed",t.fixed=1)}):s.main.drag.on("dragstart",null),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.pinMode},a.lassoMode=function(t){return arguments.length?(s.conf.lassoMode=t,s.status.graphStarted&&(s.conf.lassoMode?(s.dom.graphOverlay.call(s.main.lasso),s.main.lasso.items(s.main.nodes),s.main.lasso.on("start",function(){s.main.lasso.items().classed("selected",!1),s.tools.onLassoStart(s.main.lasso.items())}),s.main.lasso.on("draw",function(){s.main.lasso.items().filter(function(t){return t.possible===!0}).classed("selected",!0),s.main.lasso.items().filter(function(t){return t.possible===!1}).classed("selected",!1)}),s.main.lasso.on("end",function(){s.main.lasso.items().filter(function(t){return t.selected===!0}).classed("selected",!0),s.main.lasso.items().filter(function(t){return t.selected===!1}).classed("selected",!1),s.tools.onLassoEnd(s.main.lasso.items())}),s.events.mousedownLasso=s.dom.graphOverlay.on("mousedown.drag"),s.events.touchstartLasso=s.dom.graphOverlay.on("touchstart.drag"),s.dom.graphOverlay.on("mousedown.drag",s.tools.lassoEventProxy(s.events.mousedownLasso)),s.dom.graphOverlay.on("touchstart.drag",s.tools.lassoEventProxy(s.events.touchstartLasso))):(s.dom.graphOverlay.on(".drag",null),s.main.nodes.classed("selected",!1)),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.lassoMode},a.transform=function(t){return arguments.length?(s.main.zoom.translate(t.translate),s.main.zoom.scale(t.scale),s.conf.transform={translate:s.main.zoom.translate(),scale:s.main.zoom.scale()},s.conf.zoomMode&&s.status.graphStarted&&(s.dom.graph.attr("transform","translate("+s.main.zoom.translate()+")scale("+s.main.zoom.scale()+")"),s.tools.writeConfObjectIntoWizard()),a):{translate:s.main.zoom.translate(),scale:s.main.zoom.scale()}},a.zoomMode=function(t){return arguments.length?(s.conf.zoomMode=t,s.status.graphStarted&&(s.conf.zoomMode?(s.dom.graphOverlay.call(s.main.zoom),s.main.zoom.scaleExtent([s.conf.minZoomFactor,s.conf.maxZoomFactor]).size([s.tools.getGraphWidth(),s.conf.height]).on("zoom",function(){s.main.zoom.translate(d3.event.translate),
    s.main.zoom.scale(d3.event.scale),s.conf.transform={translate:s.main.zoom.translate(),scale:s.main.zoom.scale()},s.dom.graph.attr("transform","translate("+s.main.zoom.translate()+")scale("+s.main.zoom.scale()+")"),s.tools.writeConfObjectIntoWizard()}),s.events.dblclickZoom=s.dom.graphOverlay.on("dblclick.zoom"),s.events.mousedownZoom=s.dom.graphOverlay.on("mousedown.zoom"),s.events.touchstartZoom=s.dom.graphOverlay.on("touchstart.zoom"),s.dom.graphOverlay.on("dblclick.zoom",s.tools.zoomEventProxy(s.events.dblclickZoom)),s.dom.graphOverlay.on("mousedown.zoom",s.tools.zoomEventProxy(s.events.mousedownZoom)),s.dom.graphOverlay.on("touchstart.zoom",s.tools.zoomEventProxy(s.events.touchstartZoom)),JSON.stringify(s.conf.transform)!==JSON.stringify(s.confDefaults.transform)&&(s.dom.graph.attr("transform","translate("+s.main.zoom.translate()+")scale("+s.main.zoom.scale()+")"),s.tools.writeConfObjectIntoWizard())):(s.dom.graphOverlay.on(".zoom",null),s.main.zoom.translate([0,0]),s.main.zoom.scale(1),s.conf.transform={translate:[0,0],scale:1},s.dom.graph.attr("transform","translate(0,0)scale(1)")),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.zoomMode},a.minZoomFactor=function(t){return arguments.length?(s.conf.minZoomFactor=t,s.status.graphReady&&a.zoomMode(s.conf.zoomMode),a):s.conf.minZoomFactor},a.maxZoomFactor=function(t){return arguments.length?(s.conf.maxZoomFactor=t,s.status.graphReady&&a.zoomMode(s.conf.zoomMode),a):s.conf.maxZoomFactor},a.zoom=function(t,e,o){if(s.conf.zoomMode){var n=s.tools.getGraphWidth();t||(t=n/2),e||(e=s.conf.height/2),o||(o=n),s.main.zoom.scale(n/o),s.main.zoom.scale()<s.conf.minZoomFactor&&s.main.zoom.scale(s.conf.minZoomFactor),s.main.zoom.scale()>s.conf.maxZoomFactor&&s.main.zoom.scale(s.conf.maxZoomFactor),s.main.zoom.translate([n/2-t*s.main.zoom.scale(),s.conf.height/2-e*s.main.zoom.scale()]),s.conf.transform={translate:s.main.zoom.translate(),scale:s.main.zoom.scale()},s.main.zoom.event(s.dom.graphOverlay),s.tools.writeConfObjectIntoWizard()}return a},a.zoomSmooth=function(t,e,o,n){if(s.conf.zoomMode){var r=s.tools.getGraphWidth();t||(t=r/2),e||(e=s.conf.height/2),o||(o=r),n||(n=1500),s.main.zoom.scale(r/o),s.main.zoom.scale()<s.conf.minZoomFactor&&s.main.zoom.scale(s.conf.minZoomFactor),s.main.zoom.scale()>s.conf.maxZoomFactor&&s.main.zoom.scale(s.conf.maxZoomFactor),s.main.zoom.translate([r/2-t*s.main.zoom.scale(),s.conf.height/2-e*s.main.zoom.scale()]),s.conf.translate={translate:s.main.zoom.translate(),scale:s.main.zoom.scale()},s.dom.graphOverlay.transition().duration(n).call(s.main.zoom.event),s.tools.writeConfObjectIntoWizard()}return a},a.showLoadingIndicatorOnAjaxCall=function(t){return arguments.length?(s.conf.showLoadingIndicatorOnAjaxCall=t,a):s.conf.showLoadingIndicatorOnAjaxCall},a.showLoadingIndicator=function(t){return s.tools.parseBool(t)?s.dom.loading.style("display","block"):s.dom.loading.style("display","none"),a},a.alignFixedNodesToGrid=function(t){return arguments.length?(s.conf.alignFixedNodesToGrid=t,s.status.graphStarted&&(s.conf.alignFixedNodesToGrid?(s.status.graphReady&&s.main.nodes.each(function(t){t.fixed&&(t.x=t.px=s.tools.getNearestGridPosition(t.x,s.conf.width),t.y=t.py=s.tools.getNearestGridPosition(t.y,s.conf.height))}),s.main.drag.on("dragend",function(t){t.x=t.px=s.tools.getNearestGridPosition(t.x,s.conf.width),t.y=t.py=s.tools.getNearestGridPosition(t.y,s.conf.height)})):s.main.drag.on("dragend",null),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.alignFixedNodesToGrid},a.moveFixedNodes=function(t,e){return s.status.graphStarted&&(t||(t=0),e||(e=0),(0!==t||0!==e)&&s.main.nodes.each(function(o){o.fixed&&(o.x=o.px=s.conf.alignFixedNodesToGrid?s.tools.getNearestGridPosition(o.x+t,s.conf.width):o.x+t,o.y=o.py=s.conf.alignFixedNodesToGrid?s.tools.getNearestGridPosition(o.y+e,s.conf.width):o.y+e)})),a},a.gridSize=function(t){return arguments.length?(s.conf.gridSize=t,s.status.graphStarted&&s.tools.createCustomizeWizardIfNotRendering(),a):s.conf.gridSize},a.nodeEventToStopPinMode=function(t){return arguments.length?(s.conf.nodeEventToStopPinMode=t,s.status.graphStarted&&s.tools.createCustomizeWizardIfNotRendering(),a):s.conf.nodeEventToStopPinMode},a.onNodeContextmenuPreventDefault=function(t){return arguments.length?(s.conf.onNodeContextmenuPreventDefault=t,s.status.graphStarted&&s.tools.createCustomizeWizardIfNotRendering(),a):s.conf.onNodeContextmenuPreventDefault},a.nodeEventToOpenLink=function(t){return arguments.length?(s.conf.nodeEventToOpenLink=t,s.status.graphStarted&&s.tools.createCustomizeWizardIfNotRendering(),a):s.conf.nodeEventToOpenLink},a.nodeLinkTarget=function(t){return arguments.length?(s.conf.nodeLinkTarget=t,s.status.graphStarted&&s.tools.createCustomizeWizardIfNotRendering(),a):s.conf.nodeLinkTarget},a.autoRefresh=function(t){return arguments.length?(s.conf.autoRefresh=t,s.status.graphStarted&&(s.conf.autoRefresh&&s.conf.refreshInterval&&!s.conf.interval?(s.conf.interval=window.setInterval(function(){a.start()},s.conf.refreshInterval),s.tools.log("Auto refresh started with an interval of "+s.conf.refreshInterval+" milliseconds.")):!s.conf.autoRefresh&&s.conf.interval&&(clearInterval(s.conf.interval),s.conf.interval=null,s.tools.log("Auto refresh stopped.")),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.autoRefresh},a.refreshInterval=function(t){return arguments.length?(s.conf.refreshInterval=t,s.status.graphStarted&&s.tools.createCustomizeWizardIfNotRendering(),a):s.conf.refreshInterval},a.useDomParentWidth=function(t){return arguments.length?(s.conf.useDomParentWidth=t,s.status.graphStarted&&(s.conf.useDomParentWidth?(s.dom.containerWidth=s.tools.getSvgParentInnerWidth(),d3.select(window).on("resize",function(){var t=s.dom.containerWidth,e=s.tools.getSvgParentInnerWidth();t!==e&&(s.dom.containerWidth=e,a.width(s.conf.width).resume())})):d3.select(window).on("resize",null),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.useDomParentWidth},a.setDomParentPaddingToZero=function(t){return arguments.length?(s.conf.setDomParentPaddingToZero=t,s.status.graphStarted&&(s.conf.setDomParentPaddingToZero?s.dom.svgParent.style("padding","0"):s.dom.svgParent.style("padding",null),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.setDomParentPaddingToZero},a.domParentWidth=function(){return s.dom.containerWidth||s.tools.getSvgParentInnerWidth()},a.width=function(t){return arguments.length?(s.conf.width=t,s.status.graphStarted&&(s.dom.svg.attr("width",s.tools.getGraphWidth()),s.dom.graphOverlaySizeHelper.attr("width",s.tools.getGraphWidth()),s.dom.loadingRect.attr("width",s.tools.getGraphWidth()),s.dom.loadingText.attr("x",s.tools.getGraphWidth()/2),s.main.force.size([s.tools.getGraphWidth(),s.conf.height]),s.conf.zoomMode&&s.main.zoom.size([s.tools.getGraphWidth(),s.conf.height]),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.width},a.height=function(t){return arguments.length?(s.conf.height=t,s.status.graphStarted&&(s.dom.svg.attr("height",s.conf.height),s.dom.graphOverlaySizeHelper.attr("height",s.conf.height),s.dom.loadingRect.attr("height",s.conf.height),s.dom.loadingText.attr("y",s.conf.height/2),s.main.force.size([s.tools.getGraphWidth(),s.conf.height]),s.conf.showLegend&&(s.tools.removeLegend(),s.tools.createLegend()),s.conf.zoomMode&&s.main.zoom.size([s.tools.getGraphWidth(),s.conf.height]),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.height},a.minNodeRadius=function(t){return arguments.length?(s.conf.minNodeRadius=t,s.status.graphReady&&(s.tools.setRadiusFunction(),s.main.nodes.each(function(t){t.radius=s.tools.radius(t.SIZEVALUE)}),s.main.nodes.attr("r",function(t){return t.radius}),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.minNodeRadius},a.maxNodeRadius=function(t){return arguments.length?(s.conf.maxNodeRadius=t,s.status.graphReady&&(s.tools.setRadiusFunction(),s.main.nodes.each(function(t){t.radius=s.tools.radius(t.SIZEVALUE)}),s.main.nodes.attr("r",function(t){return t.radius}),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.maxNodeRadius},a.labelDistance=function(t){return arguments.length?(s.conf.labelDistance=t,s.status.graphStarted&&s.tools.createCustomizeWizardIfNotRendering(),a):s.conf.labelDistance},a.selfLinkDistance=function(t){return arguments.length?(s.conf.selfLinkDistance=t,s.status.graphStarted&&s.tools.createCustomizeWizardIfNotRendering(),a):s.conf.selfLinkDistance},a.linkDistance=function(t){return arguments.length?(s.conf.linkDistance=t,s.status.graphStarted&&(s.main.force.linkDistance(s.conf.linkDistance),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.linkDistance},a.charge=function(t){return arguments.length?(s.conf.charge=t,s.status.graphStarted&&(s.main.force.charge(s.conf.charge),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.charge},a.chargeDistance=function(t){return arguments.length?(s.conf.chargeDistance=t,s.status.graphStarted&&(s.main.force.chargeDistance(s.conf.chargeDistance),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.chargeDistance},a.gravity=function(t){return arguments.length?(s.conf.gravity=t,s.status.graphStarted&&(s.main.force.gravity(s.conf.gravity),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.gravity},a.linkStrength=function(t){return arguments.length?(s.conf.linkStrength=t,s.status.graphStarted&&(s.main.force.linkStrength(s.conf.linkStrength),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.linkStrength},a.friction=function(t){return arguments.length?(s.conf.friction=t,s.status.graphStarted&&(s.main.force.friction(s.conf.friction),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.friction},a.theta=function(t){return arguments.length?(s.conf.theta=t,s.status.graphStarted&&(s.main.force.theta(s.conf.theta),s.tools.createCustomizeWizardIfNotRendering()),a):s.conf.theta},a.positions=function(t){if(arguments.length)return s.status.graphReady?t.constructor===Array?t.forEach(function(t){void 0!==s.data.idLookup[t.ID]&&(s.data.idLookup[t.ID].fixed=s.tools.parseBool(t.fixed),s.data.idLookup[t.ID].x=s.data.idLookup[t.ID].px=t.x,s.data.idLookup[t.ID].y=s.data.idLookup[t.ID].py=t.y)}):s.tools.logError("Unable to set node positions: positions method parameter must be an array of node positions"):s.conf.positions=t,a;var e=[];return s.data.nodes.forEach(function(t){e.push({ID:t.ID,x:Math.round(t.x),y:Math.round(t.y),fixed:t.fixed?1:0})}),e},a.onLinkClickFunction=function(t){return arguments.length?(s.conf.onLinkClickFunction=t,a):s.conf.onLinkClickFunction},a.onNodeMouseenterFunction=function(t){return arguments.length?(s.conf.onNodeMouseenterFunction=t,a):s.conf.onNodeMouseenterFunction},a.onNodeMouseleaveFunction=function(t){return arguments.length?(s.conf.onNodeMouseleaveFunction=t,a):s.conf.onNodeMouseleaveFunction},a.onNodeClickFunction=function(t){return arguments.length?(s.conf.onNodeClickFunction=t,a):s.conf.onNodeClickFunction},a.onNodeDblclickFunction=function(t){return arguments.length?(s.conf.onNodeDblclickFunction=t,a):s.conf.onNodeDblclickFunction},a.onNodeContextmenuFunction=function(t){return arguments.length?(s.conf.onNodeContextmenuFunction=t,a):s.conf.onNodeContextmenuFunction},a.onLassoStartFunction=function(t){return arguments.length?(s.conf.onLassoStartFunction=t,a):s.conf.onLassoStartFunction},a.onLassoEndFunction=function(t){return arguments.length?(s.conf.onLassoEndFunction=t,a):s.conf.onLassoEndFunction},a.sampleData=function(t){return arguments.length?(s.data.sampleData=t,a):s.data.sampleData},a.data=function(){return s.data.dataConverted},a.nodeDataById=function(t){return s.data.idLookup[t]},a.options=function(t){var e;if(arguments.length)return s.tools.applyConfigurationObject(t),a;var o={};for(e in s.conf)s.conf.hasOwnProperty(e)&&(s.confDefaults.hasOwnProperty(e)?"bool"!==s.confDefaults[e].type&&"number"!==s.confDefaults[e].type&&"text"!==s.confDefaults[e].type||s.confDefaults[e].val===s.conf[e]?"object"===s.confDefaults[e].type&&JSON.stringify(s.confDefaults[e].val)!==JSON.stringify(s.conf[e])&&(o[e]=s.conf[e]):o[e]=s.conf[e]:s.confDefaults.hasOwnProperty(e)||void 0===s.conf[e]||null===s.conf[e]||(o[e]=s.conf[e]));return o},a.optionsCustomizationWizard=function(t){var e;if(arguments.length)return s.tools.applyConfigurationObject(t),a;var o={};for(e in s.confDefaults)s.confDefaults.hasOwnProperty(e)&&("bool"!==s.confDefaults[e].type&&"number"!==s.confDefaults[e].type&&"text"!==s.confDefaults[e].type||s.confDefaults[e].val===s.conf[e]?"object"===s.confDefaults[e].type&&JSON.stringify(s.confDefaults[e].val)!==JSON.stringify(s.conf[e])&&(o[e]=s.conf[e]):o[e]=s.conf[e]);return o},a.customize=function(t){return arguments.length?(s.status.customize=t,s.status.graphStarted&&(s.status.customize?s.tools.createCustomizeWizard():s.tools.removeCustomizeWizard()),a):s.status.customize},a.debug=function(t){return arguments.length?(s.conf.debug=t,s.status.graphStarted&&(s.conf.debug?s.tools.createCustomizeLink():s.tools.removeCustomizeLink()),a):s.conf.debug},a.releaseFixedNodes=function(){return s.status.graphStarted&&s.main.nodes.each(function(t){t.fixed=0}),a},a.userAgent=function(){return s.status.userAgent},a.inspect=function(){return s},a.version=function(){return s.version},s.status.apexPluginId&&apex.jQuery("#"+s.dom.containerId).bind("apexrefresh",function(){a.start()}),a}